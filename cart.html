<!DOCTYPE html>
<html lang="en">
<head>



    <meta charset="UTF-8">
    <meta name="viewport" content="width-device-width, initial-scale=1"/>
    <link href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTcHcXzlP9vRXhUzxroZf1tLyyXp3Pqc9iAMQ&s" rel="icon" type="image/x-icon" />
    <title>Cart - BMW Lovers</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!--<link href="design.css" rel="stylesheet" />-->






    <style>
        body {
            background: #0a1f44; /* dark BMW blue */
            color: #fff;
            font-family: Arial, sans-serif;
        }

        /* Navbar */
        .navbar {
            background-color: #1a2b4c; /* darker blue */
        }

            .navbar a {
                color: #fff !important;
            }



        .table th {
            background-color: #0a1f44;
            color: white;
            font-weight: bold;
        }


    </style>









</head>
<body>







    <!-- Navbar -->
    <nav class="navbar luxury-navbar bg-dark">
        <div class="container d-flex justify-content-between align-items-center">
            <div>
                <div class="d-flex align-items-center gap-3">
                    <a class="navbar-brand text-white fs-2" href="index.html"><b>BMW Toys</b></a>
                </div>


            </div>

            <div class="d-flex justify-content-between align-items-center gap-3">
                <!-- Cart link -->
                <a class="text-white text-decoration-none fs-5" href="index.html"><b>Home</b></a>
                <a class="text-white text-decoration-none fs-5" href="about.html"><b>About Us</b></a>

                <button id="logoutBtn"
                        class="btn rounded-pill text-white">
                    Logout
                </button>

            </div>
        </div>
    </nav>





    <!-- Cart Section -->
    <div class="container mt-4">
        <h2>Your Cart</h2>

        <table class="table table-bordered align-middle">
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Price</th>
                    <th>Qty</th>
                    <th>Total</th>
                    <th>Action</th>
                </tr>
            </thead>

            <tbody id="cart-body">
                <tr>
                    <td>Gift Voucher</td>
                    <td>$0</td>
                    <td>1</td>
                    <td>$0</td>
                    <td>Remove</td>
                </tr>
            </tbody>
        </table>

        <!-- Checkout Section -->
        <div class="card p-3 ">
            <h4>Checkout</h4>

            <div class="d-flex justify-content-between">
                <span>Subtotal</span>
                <span>$<span id="grand-total">0</span></span>
            </div>

            <div class="d-flex justify-content-between">
                <span>Shipping</span>
                <span>$<span id="shipping">0</span></span>
            </div>

            <hr>

            <div class="d-flex justify-content-between fw-bold">
                <span>Total</span>
                <span>$<span id="final-total">0</span></span>
            </div>















            <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
                Proceed to Checkout
            </button>

            <!-- Modal -->
            <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content border-dark border-2 rounded-3">
                        <!-- Modal Header -->
                        <div class="modal-header bg-dark">
                            <h5 class="modal-title text-white" id="exampleModalLabel">*Important Notice</h5>
                            <!-- Close button for dark header -->
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <!-- Modal Body -->
                        <div class="modal-body">
                            <p class="fw-bold text-dark">
                                Thank you for shopping with us! Please review your cart before proceeding to checkout.
                            </p>
                        </div>
                        <!-- Modal Footer -->
                        <div class="modal-footer">
                            <!-- Back button redirects to home page -->
                            <a href="index.html" class="btn btn-danger text-white">Continue Shopping</a>
                            <a href="#" class="btn btn-success">Proceed to Checkout</a>
                        </div>
                    </div>
                </div>
            </div>



        </div>
    </div>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!--<script src="sscript.js"></script>-->














    <script>




        // ---------- LOGOUT ----------
        logoutBtn?.addEventListener("click", () => {
            localStorage.removeItem("currentUser");
            window.location.href = "login.html";
        });




        const currentUser = JSON.parse(localStorage.getItem("currentUser"));

        if (!currentUser || !currentUser.email) {
            alert("Please login first");
            window.location.href = "login.html";
        }

        const userEmail = currentUser.email;
        const cartKey = `cart_${userEmail}`;
        let cart = JSON.parse(localStorage.getItem(cartKey)) || [];

        const cartBody = document.getElementById("cart-body");

        function renderCart() {
            cartBody.innerHTML = "";
            let total = 0;

            cart.forEach((item, i) => {
                const rowTotal = item.price * item.qty;
                total += rowTotal;

                cartBody.innerHTML += `
                        <tr>
                            <td><img src="${item.img}" width="60"> ${item.name}</td>
                            <td>$${item.price}</td>
                            <td>
                                <button class="btn btn-sm btn-secondary dec" data-i="${i}">-</button>
                                ${item.qty}
                                <button class="btn btn-sm btn-secondary inc" data-i="${i}">+</button>
                            </td>
                            <td>$${rowTotal}</td>
                            <td>
                                <button class="btn btn-sm btn-danger rm" data-i="${i}">Remove</button>
                            </td>
                        </tr>
                    `;
            });

            document.getElementById("grand-total").innerText = total;
            document.getElementById("final-total").innerText = total;

            attachEvents();
        }

        function attachEvents() {
            document.querySelectorAll(".inc").forEach(b =>
                b.onclick = () => { cart[b.dataset.i].qty++; save(); }
            );

            document.querySelectorAll(".dec").forEach(b =>
                b.onclick = () => {
                    const i = b.dataset.i;
                    cart[i].qty > 1 ? cart[i].qty-- : cart.splice(i, 1);
                    save();
                }
            );

            document.querySelectorAll(".rm").forEach(b =>
                b.onclick = () => {
                    cart.splice(b.dataset.i, 1);
                    save();
                }
            );
        }

        function save() {
            localStorage.setItem(cartKey, JSON.stringify(cart));
            renderCart();
        }

        renderCart();
    </script>


</body>
</html>
